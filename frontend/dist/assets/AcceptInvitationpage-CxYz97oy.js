import{a as l,j as e}from"./react-core-0npe00lJ.js";import{b as P,u as C,L as R}from"./react-router-lgh_Y1WM.js";import{n as T,E as j,D as g,x as B,C as V,o as $,y as w,q as N,F as M}from"./react-icons-B--SyvS1.js";import{o as z,p as U,B as y,l as W,A as v}from"./index-HjQGXCX9.js";import{I as k}from"./InputFields-CMQHEwPH.js";import"./react-dom-CdyVvfHO.js";import"./vendor-CGKUqG9W.js";import"./react-query-BvwtvcJK.js";import"./ui-libs-CuSWTeap.js";import"./zustand-Ccm-5Iud.js";import"./axios-B9ygI19o.js";const _=[{label:"At least 8 characters",test:t=>t.length>=8},{label:"One uppercase letter",test:t=>/[A-Z]/.test(t)},{label:"One lowercase letter",test:t=>/[a-z]/.test(t)},{label:"One number",test:t=>/[0-9]/.test(t)},{label:"One special character",test:t=>/[!@#$%^&*(),.?":{}|<>]/.test(t)}],q=()=>{const[t]=P(),c=C(),m=t.get("token")||"",[r,A]=l.useState(""),[d,E]=l.useState(""),[n,p]=l.useState({}),{data:h,isLoading:I,error:F}=z(m),{mutateAsync:S,isPending:o}=U(),x=l.useMemo(()=>_.map(s=>({...s,met:s.test(r)})),[r]),u=l.useMemo(()=>x.every(s=>s.met),[x]),L=s=>{A(s),n.password&&p(a=>({...a,password:""}))},D=s=>{E(s),n.confirmPassword&&p(a=>({...a,confirmPassword:""}))},O=async s=>{s.preventDefault();const a={};if(!u){const b=x.filter(f=>!f.met).map(f=>f.label.toLowerCase());a.password=`Password must contain ${b.join(", ")}`}if(r!==d&&(a.confirmPassword="Passwords do not match"),Object.keys(a).length>0){p(a);return}try{await S({token:m,password:r})}catch(b){console.error("Accept invitation error:",b)}};if(I)return e.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[e.jsx("div",{className:"relative",children:e.jsx(T,{className:"w-16 h-16 text-primary animate-spin mb-6"})}),e.jsx("h2",{className:"text-2xl font-bold text-primary mb-3",children:"Verifying Invitation"}),e.jsx("p",{className:"text-sm text-primary-50 text-center max-w-sm",children:"Please wait while we verify your invitation token..."})]});if(F||!h?.success)return e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx("div",{className:"w-20 h-20 rounded-full bg-red-50 flex items-center justify-center mb-6",children:e.jsx(j,{className:"w-10 h-10 text-red-500"})}),e.jsx("h2",{className:"text-2xl font-bold text-primary mb-3",children:"Invalid or Expired Invitation"}),e.jsx("p",{className:"text-sm text-primary-50 text-center mb-8 max-w-md",children:h?.message||"This invitation link is invalid or has expired. Please contact your administrator for a new invitation."}),e.jsx(y,{variant:"primary",onClick:()=>c("/login"),className:"w-full",children:"Go to Login"})]});const i=h.data;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-primary mb-2",children:"Accept Invitation"}),e.jsx("p",{className:"text-sm text-primary-50",children:"Complete your account setup to get started"})]}),i&&e.jsxs("div",{className:"bg-gradient-to-br from-primary-5 to-primary-10 rounded-2xl p-6 mb-8 border border-primary-20 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(g,{className:"w-5 h-5 text-primary"}),e.jsx("h3",{className:"text-sm font-semibold text-primary uppercase tracking-wide",children:"Invitation Details"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-4 p-3 bg-white/60 rounded-lg backdrop-blur-sm",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-primary/10 flex items-center justify-center shrink-0",children:e.jsx(B,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs font-medium text-primary-50 uppercase tracking-wide mb-1",children:"Full Name"}),e.jsx("p",{className:"text-base font-semibold text-primary truncate",children:i.name})]})]}),e.jsxs("div",{className:"flex items-start gap-4 p-3 bg-white/60 rounded-lg backdrop-blur-sm",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-primary/10 flex items-center justify-center shrink-0",children:e.jsx(V,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs font-medium text-primary-50 uppercase tracking-wide mb-1",children:"Email Address"}),e.jsx("p",{className:"text-base font-semibold text-primary truncate",children:i.email})]})]}),i.role&&e.jsxs("div",{className:"flex items-start gap-4 p-3 bg-white/60 rounded-lg backdrop-blur-sm",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-primary/10 flex items-center justify-center shrink-0",children:e.jsx(g,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs font-medium text-primary-50 uppercase tracking-wide mb-1",children:"Role"}),e.jsx("p",{className:"text-base font-semibold text-primary truncate",children:i.role.displayName})]})]}),i.tenant&&e.jsxs("div",{className:"flex items-start gap-4 p-3 bg-white/60 rounded-lg backdrop-blur-sm",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-primary/10 flex items-center justify-center shrink-0",children:e.jsx($,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs font-medium text-primary-50 uppercase tracking-wide mb-1",children:"Organization"}),e.jsx("p",{className:"text-base font-semibold text-primary truncate",children:i.tenant.name})]})]})]})]}),e.jsxs("form",{onSubmit:O,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(k,{id:"password",label:"Create Password",type:"password",placeholder:"Enter your password",value:r,onChange:s=>L(s.target.value),required:!0,icon:e.jsx(w,{className:"w-4 h-4"}),disabled:o}),n.password&&e.jsx("div",{className:"mt-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("p",{className:"text-red-700 text-xs flex items-center gap-2",children:[e.jsx(j,{className:"w-3 h-3 shrink-0"}),n.password]})})]}),r&&e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-100 rounded-xl p-4 shadow-sm",children:[e.jsxs("p",{className:"text-xs font-semibold text-blue-900 mb-3 flex items-center gap-2",children:[e.jsx(w,{className:"w-3 h-3"}),"Password Requirements"]}),e.jsx("ul",{className:"space-y-2",children:x.map((s,a)=>e.jsxs("li",{className:`flex items-center gap-2 text-xs transition-all duration-200 ${s.met?"text-green-700":"text-blue-700"}`,children:[e.jsx("div",{className:`w-4 h-4 rounded-full flex items-center justify-center shrink-0 transition-all duration-200 ${s.met?"bg-green-500 text-white":"bg-blue-200 text-blue-600"}`,children:s.met?e.jsx(N,{className:"w-2.5 h-2.5"}):e.jsx(M,{className:"w-2.5 h-2.5"})}),e.jsx("span",{className:s.met?"line-through opacity-60":"",children:s.label})]},a))}),u&&e.jsx("div",{className:"mt-3 pt-3 border-t border-green-200",children:e.jsxs("p",{className:"text-xs font-medium text-green-700 flex items-center gap-2",children:[e.jsx(g,{className:"w-3 h-3"}),"Password meets all requirements"]})})]}),e.jsxs("div",{children:[e.jsx(k,{id:"confirmPassword",label:"Confirm Password",type:"password",placeholder:"Confirm your password",value:d,onChange:s=>D(s.target.value),required:!0,icon:e.jsx(w,{className:"w-4 h-4"}),disabled:o}),d&&r===d&&e.jsx("div",{className:"mt-2 p-2 bg-green-50 border border-green-200 rounded-lg",children:e.jsxs("p",{className:"text-green-700 text-xs flex items-center gap-2",children:[e.jsx(N,{className:"w-3 h-3"}),"Passwords match"]})}),n.confirmPassword&&e.jsx("div",{className:"mt-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("p",{className:"text-red-700 text-xs flex items-center gap-2",children:[e.jsx(j,{className:"w-3 h-3 shrink-0"}),n.confirmPassword]})})]}),e.jsx(y,{type:"submit",variant:"primary",className:"w-full",loading:o,disabled:o||!u,children:o?"Creating Account...":"Accept & Create Account"})]}),e.jsx("div",{className:"pt-4 border-t border-primary-10",children:e.jsxs("p",{className:"text-xs text-center text-primary-50",children:["Already have an account?"," ",e.jsx("button",{onClick:()=>c("/login"),className:"text-primary hover:text-primary-75 font-semibold underline transition-colors",children:"Sign In"})]})})]})},ae=()=>{const[t]=P(),c=C(),m=t.get("token");return l.useEffect(()=>{m||c("/login")},[m,c]),e.jsx("div",{className:"min-h-screen flex w-full bg-lightBg",children:e.jsx("div",{className:"w-full lg:w-1/2 mx-auto flex items-center justify-center  p-6 lg:p-12 overflow-auto min-h-screen",children:e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex flex-col items-center mb-8",children:[e.jsx(R,{to:"/",children:e.jsx("img",{src:W,alt:"BKeep Accounting Logo",className:"h-16 w-auto mb-4"})}),e.jsxs("h1",{className:"text-2xl font-bold text-primary mb-2",children:["Welcome to ",v]}),e.jsx("p",{className:"text-sm text-primary-75 text-center",children:"Complete your account setup to get started"})]}),e.jsx("div",{className:"bg-white rounded-2xl shadow-xl p-6 lg:p-8 border border-primary-10",children:e.jsx(q,{})}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-xs text-primary-50 mt-2",children:["Â© ",new Date().getFullYear()," ",v,". All rights reserved."]})})]})})})};export{ae as default};
