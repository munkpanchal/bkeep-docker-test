import{a as d,j as e}from"./react-core-0npe00lJ.js";import{a as H,v as M,V as U,W,a9 as q,aa as z}from"./react-icons-B--SyvS1.js";import{u as G}from"./react-router-lgh_Y1WM.js";import{C as h}from"./ConfirmationDialog-CVwwzHxz.js";import{L as I,t as K,B as g}from"./index-HjQGXCX9.js";import{u as Q,a as X,b as Y,c as Z,d as _,e as ee}from"./journalApi-BA2jf7VK.js";import"./react-dom-CdyVvfHO.js";import"./vendor-CGKUqG9W.js";import"./react-query-BvwtvcJK.js";import"./ui-libs-CuSWTeap.js";import"./zustand-Ccm-5Iud.js";import"./axios-B9ygI19o.js";function me(){const c=G(),[s,a]=d.useState({page:1,limit:20}),[n,p]=d.useState({isOpen:!1,entry:null}),[i,x]=d.useState({isOpen:!1,entry:null}),[o,m]=d.useState({isOpen:!1,entry:null}),{data:y,isLoading:j}=Q(s),{mutate:N,isPending:b}=X(),{mutate:v,isPending:w}=Y(),{mutate:C,isPending:D}=Z(),{mutate:E}=_(),{mutate:k}=ee(),f=y?.data?.journalEntries||[],r=y?.data?.total||0,P=()=>{c("/journal-entries/new")},O=t=>{c(`/journal-entries/${t}/edit`)},S=t=>{c(`/journal-entries/${t}`)},V=t=>{p({isOpen:!0,entry:t})},J=()=>{n.entry&&N(n.entry.id,{onSuccess:()=>{p({isOpen:!1,entry:null})}})},F=t=>{x({isOpen:!0,entry:t})},$=()=>{i.entry&&v(i.entry.id,{onSuccess:()=>{x({isOpen:!1,entry:null})}})},T=t=>{m({isOpen:!0,entry:t})},A=()=>{o.entry&&C(o.entry.id,{onSuccess:()=>{m({isOpen:!1,entry:null})}})},R=t=>{E(t.id)},L=t=>{k(t.id)},B=t=>{const l={draft:{bg:"bg-gray-100",text:"text-gray-700",label:"Draft"},posted:{bg:"bg-green-100",text:"text-green-700",label:"Posted"},voided:{bg:"bg-red-100",text:"text-red-700",label:"Voided"}},u=l[t]||l.draft;return e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${u.bg} ${u.text}`,children:u.label})};return j?e.jsx(I,{}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(K,{title:"Journal Entries",subtitle:`${r} total entries`}),e.jsx("div",{className:"bg-white rounded-lg border border-primary-10 p-3",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-2",children:[e.jsx("input",{type:"text",placeholder:"Search...",value:s.search||"",onChange:t=>a({...s,search:t.target.value}),className:"px-2 py-1.5 text-sm border border-primary-10 rounded focus:ring-1 focus:ring-primary focus:border-transparent"}),e.jsxs("select",{value:s.status||"",onChange:t=>a({...s,status:t.target.value}),className:"px-2 py-1.5 text-sm border border-primary-10 rounded focus:ring-1 focus:ring-primary focus:border-transparent",children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"posted",children:"Posted"}),e.jsx("option",{value:"voided",children:"Voided"})]}),e.jsx("input",{type:"date",value:s.startDate||"",onChange:t=>a({...s,startDate:t.target.value}),className:"px-2 py-1.5 text-sm border border-primary-10 rounded focus:ring-1 focus:ring-primary focus:border-transparent",placeholder:"Start Date"}),e.jsx("input",{type:"date",value:s.endDate||"",onChange:t=>a({...s,endDate:t.target.value}),className:"px-2 py-1.5 text-sm border border-primary-10 rounded focus:ring-1 focus:ring-primary focus:border-transparent",placeholder:"End Date"})]})}),e.jsxs("div",{className:"bg-white rounded-lg border border-primary-10 overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-primary-75 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-primary-75 uppercase tracking-wider",children:"Journal No."}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-primary-75 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-primary-75 uppercase tracking-wider",children:"Debit"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-primary-75 uppercase tracking-wider",children:"Credit"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-primary-75 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-primary-75 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:f.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-3 py-8 text-center",children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx(H,{className:"w-12 h-12 text-primary-20 mb-3"}),e.jsx("p",{className:"text-sm font-medium text-primary mb-1",children:"No journal entries found"}),e.jsx("p",{className:"text-xs text-primary-50 mb-4",children:"Create your first journal entry to get started"}),e.jsxs(g,{variant:"primary",onClick:P,children:[e.jsx(M,{className:"w-4 h-4"}),"Create Journal Entry"]})]})})}):f.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>S(t.id),children:[e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-primary",children:new Date(t.journalDate).toLocaleDateString()}),e.jsxs("td",{className:"px-3 py-2 whitespace-nowrap text-sm font-medium text-primary",children:[t.journalNo,t.isAdjusting&&e.jsx("span",{className:"ml-2 text-xs text-blue-600",children:"(Adj)"})]}),e.jsx("td",{className:"px-3 py-2 text-sm text-primary-75",children:t.memo||t.lines[0]?.description||"â€”"}),e.jsxs("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-primary",children:["$",t.totalDebit.toFixed(2)]}),e.jsxs("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-primary",children:["$",t.totalCredit.toFixed(2)]}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:B(t.status)}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",onClick:l=>l.stopPropagation(),children:[t.status==="draft"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>O(t.id),className:"text-blue-600 hover:text-blue-800",title:"Edit",children:e.jsx(U,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>F(t),className:"text-green-600 hover:text-green-800",title:"Post",children:"Post"}),e.jsx("button",{onClick:()=>V(t),className:"text-red-600 hover:text-red-800",title:"Delete",children:e.jsx(W,{className:"w-4 h-4"})})]}),t.status==="posted"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>T(t),className:"text-yellow-600 hover:text-yellow-800",title:"Void",children:"Void"}),e.jsx("button",{onClick:()=>R(t),className:"text-purple-600 hover:text-purple-800",title:"Reverse",children:e.jsx(q,{className:"w-4 h-4"})})]}),t.status==="voided"&&e.jsx("button",{onClick:()=>L(t),className:"text-green-600 hover:text-green-800",title:"Restore",children:e.jsx(z,{className:"w-4 h-4"})})]})})]},t.id))})]})}),r>(s.limit||20)&&e.jsxs("div",{className:"px-3 py-2 border-t border-primary-10 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-primary-75",children:["Showing"," ",((s.page||1)-1)*(s.limit||20)+1," ","to"," ",Math.min((s.page||1)*(s.limit||20),r)," ","of ",r," entries"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(g,{variant:"outline",onClick:()=>a({...s,page:(s.page||1)-1}),disabled:(s.page||1)===1,children:"Previous"}),e.jsx(g,{variant:"outline",onClick:()=>a({...s,page:(s.page||1)+1}),disabled:(s.page||1)*(s.limit||20)>=r,children:"Next"})]})]})]}),e.jsx(h,{isOpen:n.isOpen,onClose:()=>p({isOpen:!1,entry:null}),onConfirm:J,title:"Delete Journal Entry",message:`Are you sure you want to delete journal entry "${n.entry?.journalNo}"? This action cannot be undone.`,confirmText:"Delete",cancelText:"Cancel",confirmVariant:"danger",loading:b}),e.jsx(h,{isOpen:i.isOpen,onClose:()=>x({isOpen:!1,entry:null}),onConfirm:$,title:"Post Journal Entry",message:`Are you sure you want to post journal entry "${i.entry?.journalNo}"? Posted entries cannot be edited.`,confirmText:"Post",cancelText:"Cancel",loading:w}),e.jsx(h,{isOpen:o.isOpen,onClose:()=>m({isOpen:!1,entry:null}),onConfirm:A,title:"Void Journal Entry",message:`Are you sure you want to void journal entry "${o.entry?.journalNo}"? This will mark it as voided.`,confirmText:"Void",cancelText:"Cancel",confirmVariant:"danger",loading:D})]})}export{me as default};
