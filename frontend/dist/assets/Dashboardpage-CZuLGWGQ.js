import{a as o,j as e}from"./react-core-0npe00lJ.js";import{q as J,G as K,F as q,E as G,H as W,f as V,I as Q,J as Z,K as _}from"./react-icons-B--SyvS1.js";import{R as O,B as P,C as T,X as A,Y as H,T as Y,a as X,b as ee}from"./recharts-Ns8Wy01W.js";import{C as D,R as te,E as re,P as ae}from"./ChartWidget-Cl80c2N8.js";import{S as se}from"./SummaryCard-Da2iju6y.js";import"./react-dom-CdyVvfHO.js";import"./vendor-CGKUqG9W.js";const ne=({type:r,title:n,message:l,onAccept:a,onSnooze:u,onDismiss:v})=>{const[N,S]=o.useState(!1),j={alert:"border-yellow-300 bg-yellow-50",suggestion:"border-blue-300 bg-blue-50",warning:"border-red-300 bg-red-50"},z=()=>{S(!0),v?.()};return N?null:e.jsxs("div",{className:`rounded-lg border p-4 ${j[r]} transition-all hover:shadow-md`,children:[e.jsx("div",{className:"flex items-start justify-between mb-2",children:e.jsx("h4",{className:"font-semibold text-sm text-primary",children:n})}),e.jsx("p",{className:"text-xs text-primary-75 mb-4",children:l}),e.jsxs("div",{className:"flex items-center flex-wrap gap-2",children:[a&&e.jsxs("button",{onClick:a,className:"flex items-center gap-1 px-3 py-1.5 text-xs font-medium bg-primary text-white rounded-md hover:bg-primary-75 transition-colors",children:[e.jsx(J,{className:"w-3 h-3"}),"Accept"]}),u&&e.jsxs("button",{onClick:u,className:"flex items-center gap-1 px-3 py-1.5 text-xs font-medium bg-white text-primary border border-primary-25 rounded-md hover:bg-primary-10 transition-colors",children:[e.jsx(K,{className:"w-3 h-3"}),"Snooze"]}),v&&e.jsxs("button",{onClick:z,className:"flex items-center gap-1 px-3 py-1.5 text-xs font-medium bg-white text-primary-50 border border-primary-10 rounded-md hover:bg-primary-10 transition-colors ml-auto",children:[e.jsx(q,{className:"w-3 h-3"}),"Dismiss"]})]})]})},oe=({data:r})=>{const n=r.map(a=>({name:a.location.split(" - ")[1]||a.location,utilization:a.utilization,revenue:a.revenue})),l=a=>a<50?"#EF4444":a<70?"#F59E0B":"#10B981";return e.jsx(O,{width:"100%",height:200,children:e.jsxs(P,{data:n,margin:{top:20,right:30,left:20,bottom:5},children:[e.jsx(T,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),e.jsx(A,{dataKey:"name",tick:{fontSize:11,fill:"#8B6F47"},stroke:"#8B6F47"}),e.jsx(H,{tick:{fontSize:12,fill:"#8B6F47"},stroke:"#8B6F47",tickFormatter:a=>`${a}%`}),e.jsx(Y,{contentStyle:{backgroundColor:"#fff",border:"1px solid #C56211",borderRadius:"8px"},formatter:(a,u)=>u==="utilization"?[`${a}%`,"Utilization"]:[`$${a.toLocaleString()}`,"Revenue/Hour"]}),e.jsx(X,{dataKey:"utilization",radius:[8,8,0,0],children:n.map((a,u)=>e.jsx(ee,{fill:l(a.utilization)},`cell-${u}`))})]})})},ie=({data:r})=>{const n=r.map(l=>({name:l.name,volume:l.volume,avgDays:l.avgDays}));return e.jsx(O,{width:"100%",height:250,children:e.jsxs(P,{data:n,margin:{top:20,right:30,left:20,bottom:5},children:[e.jsx(T,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),e.jsx(A,{dataKey:"name",tick:{fontSize:11,fill:"#8B6F47"},stroke:"#8B6F47",angle:-45,textAnchor:"end",height:80}),e.jsx(H,{tick:{fontSize:12,fill:"#8B6F47"},stroke:"#8B6F47",tickFormatter:l=>`$${l/1e3}k`}),e.jsx(Y,{contentStyle:{backgroundColor:"#fff",border:"1px solid #C56211",borderRadius:"8px"},formatter:(l,a)=>a==="volume"?[`$${l.toLocaleString()}`,"Claim Volume"]:[`${l} days`,"Avg Days"]}),e.jsx(X,{dataKey:"volume",fill:"#C56211",radius:[8,8,0,0],name:"volume"})]})})},le=({children:r,id:n,defaultWidth:l=280,defaultHeight:a=200,minWidth:u=200,minHeight:v=150,onResize:N,onDragStart:S,onDragEnd:j,isDragging:z=!1,dragHandleClassName:M=""})=>{const[w,t]=o.useState(()=>{const s=localStorage.getItem(`card-${n}`);if(s){const g=JSON.parse(s);return{width:g.width||l,height:g.height||a}}return{width:l,height:a}}),[i,c]=o.useState(!1),[m,x]=o.useState(!1),[d,f]=o.useState(null),[k,$]=o.useState(v),p=o.useRef(null),b=o.useRef(null),h=o.useRef({x:0,y:0,width:0,height:0}),E=o.useRef({x:0,y:0});o.useEffect(()=>{const s=localStorage.getItem(`card-${n}`);if(s){const g=JSON.parse(s);t({width:g.width||l,height:g.height||a})}},[n,l,a]),o.useEffect(()=>{const s=()=>{if(b.current){const y=b.current.firstElementChild;if(y){const F=y.style.height,I=y.style.minHeight;y.style.height="auto",y.style.minHeight="auto";const B=y.scrollHeight;y.style.height=F,y.style.minHeight=I,$(Math.max(v,B))}}},g=setTimeout(()=>{s()},0),C=new ResizeObserver(()=>{s()});return b.current&&C.observe(b.current),()=>{clearTimeout(g),C.disconnect()}},[r,v]),o.useEffect(()=>{localStorage.setItem(`card-${n}`,JSON.stringify(w)),N?.(w.width,w.height)},[w,n,N]);const R=(s,g)=>{if(s.preventDefault(),s.stopPropagation(),c(!0),f(g),p.current){const C=p.current.getBoundingClientRect();h.current={x:s.clientX,y:s.clientY,width:C.width,height:C.height}}},U=s=>{s.target.closest("[data-resize-handle]")||i||(s.preventDefault(),s.stopPropagation(),x(!0),S?.(),p.current&&(E.current={x:s.clientX,y:s.clientY}))};return o.useEffect(()=>{if(!i||!d)return;const s=d==="se"?"se-resize":d==="e"?"e-resize":"s-resize";document.body.style.cursor=s,document.body.style.userSelect="none";const g=y=>{const F=y.clientX-h.current.x,I=y.clientY-h.current.y;let B=h.current.width,L=h.current.height;(d==="se"||d==="e")&&(B=Math.max(u,h.current.width+F)),(d==="se"||d==="s")&&(L=Math.max(k,h.current.height+I)),t({width:B,height:L})},C=()=>{c(!1),f(null),document.body.style.cursor="",document.body.style.userSelect=""};return document.addEventListener("mousemove",g),document.addEventListener("mouseup",C),()=>{document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",C),document.body.style.cursor="",document.body.style.userSelect=""}},[i,d,u,k]),o.useEffect(()=>{if(!m)return;document.body.style.cursor="grabbing",document.body.style.userSelect="none";const s=()=>{x(!1),j?.(),document.body.style.cursor="",document.body.style.userSelect=""};return document.addEventListener("mouseup",s),()=>{document.removeEventListener("mouseup",s),document.body.style.cursor="",document.body.style.userSelect=""}},[m,j]),e.jsxs("div",{ref:p,className:`relative ${i||m?"select-none":""} ${z||m?"opacity-50 z-50":""} transition-opacity`,style:{width:`${w.width}px`,height:`${w.height}px`,minWidth:`${u}px`,minHeight:`${k}px`},children:[e.jsx("div",{ref:b,className:`h-full w-full ${M||"cursor-grab active:cursor-grabbing"}`,onMouseDown:U,children:r}),e.jsx("div",{"data-resize-handle":!0,className:"absolute bottom-0 right-0 w-5 h-5 cursor-se-resize group z-10",onMouseDown:s=>R(s,"se"),children:e.jsxs("div",{className:"absolute bottom-0.5 right-0.5 w-4 h-4",children:[e.jsx("div",{className:"absolute bottom-0 right-0 w-3 h-3 border-r-2 border-b-2 border-primary-30 group-hover:border-primary transition-colors"}),e.jsx("div",{className:"absolute bottom-1 right-1 w-2 h-2 border-r border-b border-primary-20 group-hover:border-primary-50 transition-colors"})]})}),e.jsx("div",{"data-resize-handle":!0,className:"absolute top-0 right-0 w-2 h-full cursor-e-resize hover:bg-primary-10 transition-colors opacity-0 hover:opacity-100 z-10",onMouseDown:s=>R(s,"e")}),e.jsx("div",{"data-resize-handle":!0,className:"absolute bottom-0 left-0 w-full h-2 cursor-s-resize hover:bg-primary-10 transition-colors opacity-0 hover:opacity-100 z-10",onMouseDown:s=>R(s,"s")})]})},ce=()=>({totalCollections:{value:"$124,580",trend:{value:8,direction:"up",period:"last month"},breakdown:[{label:"Insurance payments",value:"$89,200"},{label:"Patient payments",value:"$35,380"}],aiNotes:["Collections are tracking 8% above average this month","Insurance payments increased by 12% from last month"]},outstandingReceivables:{value:"$45,230",breakdown:[{label:"0-30 days",value:"$18,500"},{label:"31-60 days",value:"$15,200"},{label:"61-90 days",value:"$8,400"},{label:"90+ days",value:"$3,130"}],aiNotes:["$12,400 in claims are 60+ days overdue"]},cashOnHand:{value:"$89,450",indicator:"green",aiNotes:["Forecast shows a cash dip in 2 weeks due to pending lab bills"]},expenseSummary:{value:"$62,300",trend:{value:5,direction:"up",period:"last month"},breakdown:[{label:"Supplies",value:"$22,100"},{label:"Lab Fees",value:"$18,500"},{label:"Rent",value:"$12,700"}],aiNotes:["Lab costs are 18% above average — check vendor invoices"]},profitability:{value:"42%",trend:{value:3,direction:"up",period:"3 months avg"},chartData:[{month:"Jan",profitMargin:38,target:40},{month:"Feb",profitMargin:40,target:40},{month:"Mar",profitMargin:39,target:40},{month:"Apr",profitMargin:41,target:40},{month:"May",profitMargin:42,target:40}]},revenueByProcedure:[{name:"Restorative",revenue:45200,percentage:36},{name:"Cosmetic",revenue:32100,percentage:26},{name:"Preventive",revenue:28100,percentage:23},{name:"Surgical",revenue:15200,percentage:12},{name:"Orthodontic",revenue:3980,percentage:3}],insurancePerformance:[{name:"Sun Life",volume:15200,avgDays:52},{name:"Manulife",volume:12800,avgDays:38},{name:"Blue Cross",volume:11200,avgDays:45},{name:"Great-West",volume:9800,avgDays:42},{name:"Desjardins",volume:8200,avgDays:35}],dentistProductivity:[{name:"Dr. Smith",revenue:58200,procedures:145},{name:"Dr. Johnson",revenue:48400,procedures:128},{name:"Dr. Williams",revenue:38900,procedures:112}],chairUtilization:[{location:"Location A - Chair 1",utilization:78,revenue:12400},{location:"Location A - Chair 2",utilization:65,revenue:11200},{location:"Location B - Chair 1",utilization:72,revenue:11800},{location:"Location B - Chair 2",utilization:42,revenue:6800}],expenseBreakdown:[{category:"Supplies",amount:22100,percentage:35},{category:"Lab Fees",amount:18500,percentage:30},{category:"Rent",amount:12700,percentage:20},{category:"Marketing",amount:6200,percentage:10},{category:"Other",amount:2800,percentage:5}],aiInsights:[{type:"warning",title:"Overdue Insurance Claims",message:"$12,400 in claims are 60+ days overdue. Consider following up with Sun Life and Blue Cross."},{type:"suggestion",title:"Revenue Opportunity",message:"Cosmetic treatments dropped 10% this quarter — consider promotions or marketing campaigns."},{type:"alert",title:"Chair Utilization Alert",message:"Chair 2 in Location B underutilized — only 42% booked last month."},{type:"warning",title:"Expense Anomaly",message:"Lab costs are 18% above average — check vendor invoices for discrepancies."}]}),ye=()=>{const r=ce(),[n,l]=o.useState(()=>{try{const t=localStorage.getItem("dashboard-card-order");if(t)return JSON.parse(t)}catch(t){console.warn("Failed to load card order from localStorage",t)}return["total-collections","outstanding-receivables","cash-on-hand","expense-summary","profitability"]}),[a,u]=o.useState(null),[v,N]=o.useState(null),S=o.useRef(null),j=o.useRef(new Map);o.useEffect(()=>{try{localStorage.setItem("dashboard-card-order",JSON.stringify(n))}catch(t){console.warn("Failed to save card order to localStorage",t)}},[n]);const z=t=>{u(t)},M=()=>{if(a!==null&&v!==null){const t=n.indexOf(a);if(t!==-1&&t!==v){const i=[...n],[c]=i.splice(t,1);i.splice(v,0,c),l(i)}}u(null),N(null)};o.useEffect(()=>{if(!a||!S.current)return;const t=i=>{const c=S.current?.getBoundingClientRect();if(!c)return;const m=i.clientX-c.left,x=i.clientY-c.top;let d=n.length;for(let f=0;f<n.length;f++){const k=n[f];if(k===a)continue;const $=j.current.get(k);if(!$)continue;const p=$.getBoundingClientRect(),b=p.left-c.left,h=p.top-c.top;if(m>=b&&m<=b+p.width&&x>=h&&x<=h+p.height){const E=b+p.width/2,R=h+p.height/2;m<E||x<R?d=f:d=f+1;break}if(x<h||x<h+p.height&&m<b){d=f;break}}N(d)};return document.addEventListener("mousemove",t),()=>{document.removeEventListener("mousemove",t)}},[a,n]);const w=[{id:"total-collections",title:"Total Collections",value:r.totalCollections.value,trend:r.totalCollections.trend,breakdown:r.totalCollections.breakdown,aiNotes:r.totalCollections.aiNotes,icon:e.jsx(W,{})},{id:"outstanding-receivables",title:"Outstanding Receivables",value:r.outstandingReceivables.value,breakdown:r.outstandingReceivables.breakdown,aiNotes:r.outstandingReceivables.aiNotes,icon:e.jsx(V,{})},{id:"cash-on-hand",title:"Cash on Hand",value:r.cashOnHand.value,indicator:r.cashOnHand.indicator,aiNotes:r.cashOnHand.aiNotes,icon:e.jsx(Q,{})},{id:"expense-summary",title:"Expense Summary",value:r.expenseSummary.value,trend:r.expenseSummary.trend,breakdown:r.expenseSummary.breakdown,aiNotes:r.expenseSummary.aiNotes,icon:e.jsx(Z,{})},{id:"profitability",title:"Profitability",value:r.profitability.value,trend:r.profitability.trend,icon:e.jsx(_,{})}];return e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-primary mb-4",children:"Key Metrics"}),e.jsx("div",{ref:S,className:"flex flex-wrap gap-4 relative",children:n.map((t,i)=>{const c=w.find(d=>d.id===t);if(!c)return null;const m=a===t,x=v===i&&a!==null&&!m;return e.jsxs("div",{ref:d=>{d?j.current.set(t,d):j.current.delete(t)},className:"relative",style:{order:m?999:i},children:[x&&e.jsx("div",{className:"absolute -left-2 top-0 bottom-0 w-1 bg-primary rounded z-40"}),e.jsx(le,{id:t,defaultWidth:320,defaultHeight:320,isDragging:m,onDragStart:()=>z(t),onDragEnd:M,children:e.jsx(se,{title:c.title,value:c.value,trend:c.trend,breakdown:c.breakdown,aiNotes:c.aiNotes,indicator:c.indicator,icon:c.icon})})]},t)})})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-primary mb-4",children:"Analytics & Reports"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsx(D,{title:"Revenue by Procedure Type",subtitle:"This month's revenue breakdown",aiInsight:"Cosmetic treatments dropped 10% this quarter — consider promotions.",children:e.jsx(te,{data:r.revenueByProcedure})}),e.jsx(D,{title:"Insurance Performance Tracker",subtitle:"Top 5 insurance providers by claim volume",aiInsight:"Claims from Sun Life average 52 days — slower than usual.",children:e.jsx(ie,{data:r.insurancePerformance})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(D,{title:"Dentist Productivity",subtitle:"Revenue and procedures per dentist",children:e.jsx("div",{className:"space-y-4",children:r.dentistProductivity.map((t,i)=>e.jsxs("div",{className:"border-l-4 border-primary pl-4",children:[e.jsx("div",{className:"font-semibold text-primary mb-1",children:t.name}),e.jsxs("div",{className:"text-sm text-primary-75",children:["$",t.revenue.toLocaleString()," ","revenue"]}),e.jsxs("div",{className:"text-xs text-primary-50",children:[t.procedures," procedures"]})]},`${t.name}-${i}`))})}),e.jsx(D,{title:"Chair Utilization",subtitle:"% of available hours used",aiInsight:"Chair 2 in Location B underutilized — only 42% booked last month.",children:e.jsx(oe,{data:r.chairUtilization})})]}),e.jsx(D,{title:"Expense Breakdown",subtitle:"This month's expenses by category",aiInsight:"Supply costs 12% higher than regional benchmark for similar practices.",actions:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"text-xs px-2 py-1 bg-primary-10 text-primary rounded hover:bg-primary-25",children:"This Month"}),e.jsx("button",{className:"text-xs px-2 py-1 text-primary-50 rounded hover:bg-primary-10",children:"YTD"})]}),children:e.jsx(re,{data:r.expenseBreakdown})}),e.jsx(D,{title:"Profitability Trend",subtitle:"Net profit margin over the last 5 months",aiInsight:"Profitability is trending upward and exceeding target.",children:e.jsx(ae,{data:r.profitability.chartData})})]}),e.jsx("div",{className:"flex flex-col gap-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-primary-10 p-6 sticky top-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(G,{className:"text-primary"}),e.jsx("h3",{className:"text-lg font-semibold text-primary",children:"AI Insights & Actions"})]}),e.jsx("div",{className:"space-y-4",children:r.aiInsights.map((t,i)=>e.jsx(ne,{type:t.type,title:t.title,message:t.message,onAccept:()=>console.log("Accepted",i),onSnooze:()=>console.log("Snoozed",i),onDismiss:()=>console.log("Dismissed",i)},`insight-${i}`))})]})})]})]})]})};export{ye as default};
