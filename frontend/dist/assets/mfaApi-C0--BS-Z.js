import{u as o,b as c,a as i}from"./react-query-BvwtvcJK.js";import{s as r,f as u,q as a}from"./index-HjQGXCX9.js";async function T(){return(await a.get("/authenticator/status")).data}async function y(){return(await a.post("/authenticator/setup")).data}async function l(e){return(await a.post("/authenticator/verify",{code:e})).data}async function d(e){return(await a.post("/auth/totp/login",e)).data}async function p(){return(await a.post("/authenticator/deactivate")).data}const g=()=>c({queryKey:["totp-status"],queryFn:T}),O=()=>o({mutationFn:y,onError:e=>{console.error("Setup TOTP Failed:",e);const t=e.response?.data?.message||"Failed to setup TOTP authenticator";r(t)}}),b=()=>{const e=i();return o({mutationFn:s=>l(s),onSuccess:s=>{u(s?.message||"TOTP authenticator enabled successfully"),e.invalidateQueries({queryKey:["totp-status"]}),e.invalidateQueries({queryKey:["mfa-status"]})},onError:s=>{console.error("Verify TOTP Failed:",s);const n=s.response?.data?.message||"Invalid code. Please try again.";r(n)}})},f=()=>{const e=i();return o({mutationFn:p,onSuccess:s=>{u(s?.message||"TOTP authenticator disabled successfully"),e.invalidateQueries({queryKey:["totp-status"]}),e.invalidateQueries({queryKey:["mfa-status"]})},onError:s=>{console.error("Disable TOTP Failed:",s);const n=s.response?.data?.message||"Failed to disable TOTP authenticator";r(n)}})},E=()=>o({mutationFn:e=>d(e),onError:e=>{console.error("TOTP Login Failed:",e);const t=e.response?.data?.message||"Invalid code. Please try again.";r(t)}});export{O as a,b,g as c,f as d,E as u};
