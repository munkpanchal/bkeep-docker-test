import{a as l,j as e}from"./react-core-0npe00lJ.js";import{W as O,v as $}from"./react-icons-B--SyvS1.js";import{B as o}from"./index-HjQGXCX9.js";import{I as v}from"./InputFields-CMQHEwPH.js";function U({initialData:n,onSubmit:C,onCancel:w,isLoading:d=!1}){const[g,k]=l.useState(n?.journalNo||""),[b,S]=l.useState(n?.journalDate||new Date().toISOString().split("T")[0]),[f,A]=l.useState(n?.isAdjusting||!1),[a,m]=l.useState(n?.lines||[{accountId:"",debit:0,credit:0,description:"",name:"",salesTax:0},{accountId:"",debit:0,credit:0,description:"",name:"",salesTax:0}]),[j,I]=l.useState(n?.memo||""),[p,F]=l.useState([]),[u,T]=l.useState(n?.isRecurring||!1),[N,D]=l.useState(n?.recurringFrequency),R=()=>{const t=a.reduce((r,i)=>r+(Number(i.debit)||0),0),s=a.reduce((r,i)=>r+(Number(i.credit)||0),0);return{totalDebit:t,totalCredit:s}},{totalDebit:h,totalCredit:y}=R(),x=h===y,E=()=>{m([...a,{accountId:"",debit:0,credit:0,description:"",name:"",salesTax:0}])},M=t=>{a.length>2&&m(a.filter((s,r)=>r!==t))},c=(t,s,r)=>{const i=[...a];i[t]={...i[t],[s]:r},m(i)},q=t=>{t.target.files&&F(Array.from(t.target.files))},J=t=>{if(t.preventDefault(),!x){alert("Debits and Credits must balance!");return}const s={journalNo:g,journalDate:b,isAdjusting:f,lines:a.map(r=>({accountId:r.accountId,debit:Number(r.debit),credit:Number(r.credit),description:r.description,name:r.name,salesTax:Number(r.salesTax)||0})),memo:j,attachments:p.length>0?p:void 0,isRecurring:u,recurringFrequency:N};C(s)},B=()=>{m([{accountId:"",debit:0,credit:0,description:"",name:"",salesTax:0},{accountId:"",debit:0,credit:0,description:"",name:"",salesTax:0}])};return e.jsxs("form",{onSubmit:J,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsx(v,{label:"Journal date",type:"date",value:b,onChange:t=>S(t.target.value),required:!0}),e.jsx(v,{label:"Journal no.",type:"text",value:g,onChange:t=>k(t.target.value),placeholder:"Auto-generated if empty"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"isAdjusting",checked:f,onChange:t=>A(t.target.checked),className:"w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary"}),e.jsx("label",{htmlFor:"isAdjusting",className:"text-sm font-medium text-primary",children:"Is Adjusting Journal Entry?"})]})]}),e.jsx("div",{className:"overflow-x-auto border border-primary-10 rounded-lg",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-2 text-left text-xs font-medium text-primary-75 uppercase tracking-wider",children:"#"}),e.jsx("th",{className:"px-2 py-2 text-left text-xs font-medium text-primary-75 uppercase tracking-wider",children:"ACCOUNT"}),e.jsx("th",{className:"px-2 py-2 text-left text-xs font-medium text-primary-75 uppercase tracking-wider",children:"DEBITS"}),e.jsx("th",{className:"px-2 py-2 text-left text-xs font-medium text-primary-75 uppercase tracking-wider",children:"CREDITS"}),e.jsx("th",{className:"px-2 py-2 text-left text-xs font-medium text-primary-75 uppercase tracking-wider",children:"DESCRIPTION"}),e.jsx("th",{className:"px-2 py-2 text-left text-xs font-medium text-primary-75 uppercase tracking-wider",children:"NAME"}),e.jsx("th",{className:"px-2 py-2 text-left text-xs font-medium text-primary-75 uppercase tracking-wider",children:"SALES TAX"}),e.jsx("th",{className:"px-2 py-2 text-left text-xs font-medium text-primary-75 uppercase tracking-wider"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:a.map((t,s)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-2 py-2 text-sm text-primary",children:s+1}),e.jsx("td",{className:"px-2 py-2",children:e.jsx("input",{type:"text",value:t.accountId,onChange:r=>c(s,"accountId",r.target.value),className:"w-full px-2 py-1 text-sm border border-primary-10 rounded focus:ring-1 focus:ring-primary focus:border-transparent",placeholder:"Account ID",required:!0})}),e.jsx("td",{className:"px-2 py-2",children:e.jsx("input",{type:"number",step:"0.01",value:t.debit,onChange:r=>c(s,"debit",parseFloat(r.target.value)||0),className:"w-full px-2 py-1 text-sm border border-primary-10 rounded focus:ring-1 focus:ring-primary focus:border-transparent",placeholder:"0.00"})}),e.jsx("td",{className:"px-2 py-2",children:e.jsx("input",{type:"number",step:"0.01",value:t.credit,onChange:r=>c(s,"credit",parseFloat(r.target.value)||0),className:"w-full px-2 py-1 text-sm border border-primary-10 rounded focus:ring-1 focus:ring-primary focus:border-transparent",placeholder:"0.00"})}),e.jsx("td",{className:"px-2 py-2",children:e.jsx("input",{type:"text",value:t.description,onChange:r=>c(s,"description",r.target.value),className:"w-full px-2 py-1 text-sm border border-primary-10 rounded focus:ring-1 focus:ring-primary focus:border-transparent",placeholder:"Description"})}),e.jsx("td",{className:"px-2 py-2",children:e.jsx("input",{type:"text",value:t.name||"",onChange:r=>c(s,"name",r.target.value),className:"w-full px-2 py-1 text-sm border border-primary-10 rounded focus:ring-1 focus:ring-primary focus:border-transparent",placeholder:"Name"})}),e.jsx("td",{className:"px-2 py-2",children:e.jsx("input",{type:"number",step:"0.01",value:t.salesTax||0,onChange:r=>c(s,"salesTax",parseFloat(r.target.value)||0),className:"w-full px-2 py-1 text-sm border border-primary-10 rounded focus:ring-1 focus:ring-primary focus:border-transparent",placeholder:"0.00"})}),e.jsx("td",{className:"px-2 py-2",children:a.length>2&&e.jsx("button",{type:"button",onClick:()=>M(s),className:"text-red-600 hover:text-red-800",children:e.jsx(O,{})})})]},s))}),e.jsx("tfoot",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("td",{colSpan:2,className:"px-2 py-2 text-right font-semibold text-sm text-primary",children:"Total"}),e.jsxs("td",{className:"px-2 py-2 font-semibold text-sm text-primary",children:["$",h.toFixed(2)]}),e.jsxs("td",{className:"px-2 py-2 font-semibold text-sm text-primary",children:["$",y.toFixed(2)]}),e.jsx("td",{colSpan:4})]})})]})}),!x&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-2",children:e.jsxs("p",{className:"text-xs text-red-800 font-medium",children:["⚠️ Debits and Credits must balance! Difference: $",Math.abs(h-y).toFixed(2)]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(o,{type:"button",variant:"outline",onClick:E,children:[e.jsx($,{className:"w-4 h-4"}),"Add lines"]}),e.jsx(o,{type:"button",variant:"outline",onClick:B,children:"Clear all lines"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-primary mb-1",children:"Memo"}),e.jsx("textarea",{value:j,onChange:t=>I(t.target.value),rows:3,className:"w-full px-2 py-1.5 text-sm border border-primary-10 rounded focus:ring-1 focus:ring-primary focus:border-transparent",placeholder:"Add notes about this journal entry..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-primary mb-1",children:"Attachments"}),e.jsxs("div",{className:"border-2 border-dashed border-primary-10 rounded-lg p-4 text-center",children:[e.jsx("input",{type:"file",multiple:!0,onChange:q,className:"hidden",id:"file-upload",accept:".pdf,.jpg,.jpeg,.png,.doc,.docx"}),e.jsxs("label",{htmlFor:"file-upload",className:"cursor-pointer text-primary hover:text-primary-75",children:[e.jsx("p",{className:"text-sm",children:"Add attachment"}),e.jsx("p",{className:"text-xs text-primary-50 mt-1",children:"Max file size: 20 MB"})]}),p.length>0&&e.jsxs("div",{className:"mt-3 text-xs text-primary-75",children:[p.length," file(s) selected"]})]})]})]}),e.jsxs("div",{className:"border border-primary-10 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("input",{type:"checkbox",id:"isRecurring",checked:u,onChange:t=>T(t.target.checked),className:"w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary"}),e.jsx("label",{htmlFor:"isRecurring",className:"text-sm font-medium text-primary",children:"Make recurring"})]}),u&&e.jsxs("div",{className:"ml-6",children:[e.jsx("label",{className:"block text-sm font-medium text-primary mb-1",children:"Frequency"}),e.jsxs("select",{value:N||"",onChange:t=>D(t.target.value),className:"px-2 py-1.5 text-sm border border-primary-10 rounded focus:ring-1 focus:ring-primary focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select frequency"}),e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"yearly",children:"Yearly"})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-3 border-t border-primary-10",children:[e.jsx(o,{type:"button",variant:"outline",onClick:w,disabled:d,children:"Cancel"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{type:"submit",variant:"primary",disabled:d||!x,loading:d,children:"Save"}),e.jsx(o,{type:"submit",variant:"primary",disabled:d||!x,loading:d,children:"Save and new"})]})]})]})}export{U as J};
