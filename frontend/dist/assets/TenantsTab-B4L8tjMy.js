import{a as o,j as e}from"./react-core-0npe00lJ.js";import{F as b,o as j,v}from"./react-icons-B--SyvS1.js";import{E as w,B as x,G as C}from"./index-HjQGXCX9.js";import{C as y}from"./Chips-3gluTL3o.js";import{I as g}from"./InputFields-CMQHEwPH.js";import"./react-dom-CdyVvfHO.js";import"./vendor-CGKUqG9W.js";import"./react-query-BvwtvcJK.js";import"./ui-libs-CuSWTeap.js";import"./react-router-lgh_Y1WM.js";import"./zustand-Ccm-5Iud.js";import"./axios-B9ygI19o.js";const S=({isOpen:n,onClose:l})=>{const[r,c]=o.useState({name:"",schemaName:""}),[m,h]=o.useState({}),{mutateAsync:u,isPending:i}=w();o.useEffect(()=>(n?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[n]),o.useEffect(()=>{const a=N=>{N.key==="Escape"&&n&&!i&&l()};return n&&document.addEventListener("keydown",a),()=>{document.removeEventListener("keydown",a)}},[n,l,i]);const t=a=>{a.target===a.currentTarget&&!i&&l()},p=a=>a.toLowerCase().replace(/[^a-z0-9\s]/g,"").replace(/\s+/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,""),f=a=>{c({name:a,schemaName:p(a)})},s=()=>{const a={};return r.name.trim()?r.name.trim().length<2&&(a.name="Tenant name must be at least 2 characters"):a.name="Tenant name is required",r.schemaName.trim()?/^[a-z0-9_]+$/.test(r.schemaName)?r.schemaName.length<2&&(a.schemaName="Schema name must be at least 2 characters"):a.schemaName="Schema name can only contain lowercase letters, numbers, and underscores":a.schemaName="Schema name is required",h(a),Object.keys(a).length===0},d=async a=>{if(a.preventDefault(),!!s())try{await u({name:r.name.trim(),schemaName:r.schemaName.trim()}),c({name:"",schemaName:""}),h({}),l()}catch(N){console.error("Create tenant error:",N)}};return n?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm px-4",onClick:t,children:e.jsxs("div",{className:"w-full max-w-md rounded-2xl bg-white p-6 shadow-2xl",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-primary",children:"Create New Tenant"}),e.jsx("button",{onClick:l,disabled:i,className:"text-primary-50 hover:text-primary transition-colors disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Close",children:e.jsx(b,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:d,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(g,{id:"tenant-name",label:"Tenant Name",placeholder:"e.g., Sun Medicose",value:r.name,onChange:a=>f(a.target.value),required:!0}),m.name&&e.jsx("p",{className:"text-red-500 text-xs mt-1 pl-1",children:m.name})]}),e.jsxs("div",{children:[e.jsx(g,{id:"schema-name",label:"Schema Name",placeholder:"e.g., sun_medicose",value:r.schemaName,onChange:a=>c({...r,schemaName:a.target.value.toLowerCase()}),required:!0}),m.schemaName&&e.jsx("p",{className:"text-red-500 text-xs mt-1 pl-1",children:m.schemaName}),e.jsx("p",{className:"text-primary-50 text-xs mt-1 pl-1",children:"Lowercase letters, numbers, and underscores only. Auto-generated from tenant name."})]}),e.jsxs("div",{className:"mt-6 flex flex-col gap-3 sm:flex-row sm:justify-end",children:[e.jsx(x,{type:"button",variant:"outline",className:"flex-1 sm:flex-initial",onClick:l,disabled:i,children:"Cancel"}),e.jsx(x,{type:"submit",variant:"primary",className:"flex-1 sm:flex-initial",loading:i,children:"Create Tenant"})]})]})]})}):null},B=()=>{const[n,l]=o.useState({page:1,limit:20,sort:"createdAt",order:"asc"}),[r,c]=o.useState(!1),{data:m,isLoading:h,isError:u}=C(n),i=m?.data?.items||[],t=m?.data?.pagination,p=s=>{l(d=>({...d,page:s}))},f=(s,d)=>{l(a=>({...a,sort:s,order:d,page:1}))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-semibold text-primary flex items-center gap-2",children:[e.jsx(j,{className:"w-4 h-4"}),e.jsx("span",{children:"Tenants Management"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-primary-50",children:[e.jsx(j,{className:"w-4 h-4"}),e.jsxs("span",{children:[t?.total||0," tenant",(t?.total||i.length)!==1?"s":""]})]}),e.jsxs(x,{onClick:()=>c(!0),size:"sm",children:[e.jsx(v,{className:"w-3 h-3"}),"Create Tenant"]})]})]}),h?e.jsx("div",{className:"text-center py-8 text-primary-50",children:"Loading tenants..."}):u?e.jsx("div",{className:"text-center py-8 text-red-500",children:"Failed to load tenants. Please try again."}):i.length===0?e.jsx("div",{className:"text-center py-8 text-primary-50",children:"No tenants found"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-primary-10",children:[e.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-primary",children:e.jsxs("button",{onClick:()=>f("name",n.order==="asc"?"desc":"asc"),className:"flex items-center gap-2 hover:text-primary-75 transition-colors",children:["Name",e.jsx("span",{className:"text-xs",children:n.sort==="name"?n.order==="asc"?"↑":"↓":""})]})}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-primary",children:"Created At"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-primary",children:"Status"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-primary",children:"Is Primary"})]})}),e.jsx("tbody",{children:i.map(s=>e.jsxs("tr",{className:"border-b border-primary-10 hover:bg-primary-5 transition-colors",children:[e.jsx("td",{className:"py-3 px-4 text-sm text-primary font-medium",children:s.name}),e.jsx("td",{className:"py-3 px-4 text-sm",children:new Date(s.createdAt).toLocaleDateString()}),e.jsx("td",{className:"py-3 px-4 text-sm",children:e.jsx(y,{label:s.isActive?"Active":"Inactive",variant:s.isActive?"success":"danger"})}),e.jsx("td",{className:"py-3 px-4 text-sm text-center",children:e.jsx(y,{label:s.isPrimary?"Primary":"NA",variant:s.isPrimary?"success":"danger"})})]},s.id))})]})}),t&&t.totalPages>1&&e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-primary-10",children:[e.jsxs("div",{className:"text-sm text-primary-50",children:["Showing page ",t.page," of"," ",t.totalPages," (",t.total," ","total tenants)"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(x,{variant:"outline",size:"sm",onClick:()=>p(t.page-1),disabled:!t.hasPreviousPage,children:"Previous"}),e.jsx(x,{variant:"outline",size:"sm",onClick:()=>p(t.page+1),disabled:!t.hasNextPage,children:"Next"})]})]})]}),e.jsx(S,{isOpen:r,onClose:()=>c(!1)})]})};export{B as default};
